Long inputRoleId = user.getRoleId();

// Validar acceso de forma expl√≠cita
if (inputRoleId == null || !isRoleIdValidoParaUsuario(inputRoleId, currentUser)) {
    throw new AccessDeniedException("No autorizado para asignar este rol.");
}

// Ya validado: cargar el rol desde BD
Optional<Role> optionalRole = roleRepository.findById(inputRoleId);
if (optionalRole.isEmpty()) {
    throw new IllegalArgumentException("El rol especificado no existe.");
}
Role role = optionalRole.get();
appUser.setRole(role);
