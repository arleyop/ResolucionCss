<div class="container">
  <div class="row">
    <div class="col-10 mx-auto">
      <div class="container py-5">
        <div class="row pb-2 align-items-center">
          <div class="col">
            <h1>Carga Ficha Técnica</h1>
          </div>
        </div>
        <div class="row">
          <div
            *ngIf="penomperDependencia; then thenBlock; else elseBlock"
          ></div>
          <ng-template #thenBlock>
            <h3>
              Para el cliente {{ penomperDependencia }}
              (<i>{{ petipdocDependencia }}-{{ penumdocDependencia }}</i>)
            </h3>
          </ng-template>
          <ng-template #elseBlock>
            <p>
              Carga tipo Excel, el cual contiene la información pertinente de
              los clientes interconectados:
            </p>
          </ng-template>
        </div>

        <!-- Drag & Drop para cargar archivo -->
        <div
          class="drag-drop-area"
          (drop)="onDrop($event)"
          (dragover)="onDragOver($event)"
          (dragleave)="onDragLeave($event)"
        >
          <div class="file-upload pt-4">
            <input
              type="file"
              (change)="onFileSelected($event)"
              accept=".xlsx"
              hidden
              #fileInput
            />
            <div class="text-center">
              <p>
                Por favor, selecciona un archivo Excel válido (.xlsx) de hasta
                10MB.
              </p>
            </div>
            <app-request-button
              (click)="fileInput.click()"
              [isLoading]="isLoadingFile"
              [disabled]="disabled"
              icon="upload-cloud"
            >
              Seleccionar archivo
            </app-request-button>
            <div class="text-center">
              <small>Arrastra tu archivo aquí</small>
            </div>
          </div>
        </div>

        <!-- Tabla de previsualización -->
        <div *ngIf="resumenData.length > 0" class="mt-4">
          <h3>Previsualización de clientes</h3>
          <table
            mat-table
            [dataSource]="resumenData"
            class="mat-elevation-z8 w-100"
          >
            <!-- ID -->
            <ng-container matColumnDef="id">
              <th mat-header-cell *matHeaderCellDef> Identificación </th>
              <td mat-cell *matCellDef="let row"> {{ row.id }} </td>
            </ng-container>

            <!-- TipoId -->
            <ng-container matColumnDef="tipoId">
              <th mat-header-cell *matHeaderCellDef> Tipo Documento </th>
              <td mat-cell *matCellDef="let row"> {{ row.tipoId }} </td>
            </ng-container>

            <!-- Nombre Cliente -->
            <ng-container matColumnDef="nombreCliente">
              <th mat-header-cell *matHeaderCellDef> Cliente </th>
              <td mat-cell *matCellDef="let row"> {{ row.nombreCliente }} </td>
            </ng-container>

            <!-- Criterio -->
            <ng-container matColumnDef="criterio">
              <th mat-header-cell *matHeaderCellDef> Criterio </th>
              <td mat-cell *matCellDef="let row"> {{ row.criterio }} </td>
            </ng-container>

            <!-- CriterioId -->
            <ng-container matColumnDef="criterioId">
              <th mat-header-cell *matHeaderCellDef> ID Criterio </th>
              <td mat-cell *matCellDef="let row"> {{ row.criterioId }} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
