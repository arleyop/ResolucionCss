// ValidaciÃ³n de rol
Long roleId = user.getRoleId();
if (!usuarioAutenticadoPuedeAsignarRol(roleId)) {
    throw new SecurityException("No autorizado para asignar este rol.");
}
Role role = roleRepository.findById(roleId)
    .orElseThrow(() -> new RuntimeException("Rol no encontrado"));

// Crear y guardar usuario
appUser.setContrasenia(passwordEncoder.encode(user.getContrasenia()));
appUser.setRol(role);
userRepository.save(appUser);
